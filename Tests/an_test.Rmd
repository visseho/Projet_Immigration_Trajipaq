---
title: "df_scripted"
author: "Théa Carlier"
date: "2023-05-03"
output:
  html_document: default
  pdf_document: default
---

```{r}

# Chargement des librairies

library(readr)
library(dplyr)
library(tidyverse)
library(ggthemes)
```

```{r}

# Chargement de la base de données

df_scripted <- read_csv("df_scripted")
```

# Analyse par régression logistique de la relation entre le niveau d'éducation et le revenu net

```{r}

# Création du modèle de régression logistique

lrm1 <- glm(formula = HLEV2G_2 ~ CFATINC, family = "binomial", data = df_scripted)

# Affichage du modèle

summary(lrm1)
```

```{r}

# Visualisation du modèle

ggplot(df_scripted %>% filter(!is.na(HLEV2G_2)), aes(x = CFATINC, y = HLEV2G_2)) +
  geom_point() +
  stat_smooth(method = "glm", color = "red", se = FALSE,
              method.args = list(family = binomial)) +
  labs(
    title = "Salaire net selon le niveau d'éducation", 
    x = "Salaire net", 
    y = "Diplome universitaire (0 = non ; 1 = oui)") +
  theme_few()
```

# Analyse ANOVA de la relation entre l'âge et le revenu net contrôlé par le niveau d'éducation

```{r}

# Modèle d'analyse ANOVA

df_scripted %>%
  select(AGEGP, 
         CFATINC, 
         HLEV2G_2) %>%
  drop_na() %>%
  aov(CFATINC ~ AGEGP + HLEV2G_2, data = .) %>%
  summary()
```

```{r}

# Visualisation du modèle d'analyse ANOVA

ggplot(df_scripted %>% filter(!is.na(HLEV2G_2), !is.na(AGEGP_2)), aes(x = as.factor(AGEGP_2), y = CFATINC, fill = as.factor(HLEV2G_2))) +
  geom_boxplot(na.rm = TRUE) +
  labs(
    title = "Salaire net selon le groupe d'âge, contrôlé par le niveau d'éducation", 
    x = "Salaire net", 
    y = "Groupe d'âge (1 = [18;34] ; 2 = [35;60] ; 3 = [60;99]") +
  facet_wrap(~ as.factor(HLEV2G_2), scales = "free_x") +
  scale_fill_brewer(name = "Diplôme universitaire (0 = non ; 1 = oui)", palette = "Set1") +
  theme_few()
```

